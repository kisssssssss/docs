---
title: 存储系统
index: 3
typora-root-url: ./..\..\..\public
---

# 指令系统

## 指令集体系结构

**机器指令**（简称**指令**）是指示计算机执行某种操作的命令。

一台计算机的**所有指令的集合构成该机的指令系统，也称指令集**。指令系统是**指令集体系结构（ISA）**中最核心的部分，ISA完整定义了软件和硬件之间的接口，是机器语言或汇编语言程序员所应熟悉的。

ISA规定的内容主要包括：

1. 指令格式，指令寻址方式，操作类型，以及每种操作对应的操作数的相应规定。
2. 操作数的类型，操作数寻址方式，以及是按大端方式还是按小端方式存放。
3. 程序可访问的寄存器编号、个数和位数，存储空间的大小和编址方式。
4. 指令执行过程的控制方式等，包括程序计数器、条件码定义等。

ISA规定了机器级程序的格式，机器语言或汇编语言程序员必须对机器的ISA非常熟悉。

## 指令字长

**指令字长**是指一条指令所包含的二进制代码的位数，其**取决于操作码的长度、地址码的长度和地址码的个数**。

![](/images/计算机/计算机组成原理/240.png)

根据指令长度可以将指令分为：

- **单字长指令**：指令长度等于机器字长的指令。
- **半字长指令**：指令长度等于半个机器字长的指令。
- **双字长指令**：指令长度等于两个机器字长的指令。

**指令字长与机器字长没有固定的关系**，它既可以等于机器字长，又可以大于或小于机器字长。

**指令长度的不同会导致取指令时间开销的不同**。例如，单字长指令只需访存1次就能将指令完整取出；而双字长指令则需访存2次才能完整取出，耗费2个存取周期。

- **定长指令字结构**：在一个指令系统中，若所有指令的长度都是相等的。定字长指令的执行速度快，控制简单。
- **变长指令字结构**：若各种指令的长度随指令功能而异。

因为主存一般是按字节编址的，所以**指令字长通常为字节的整数倍**。

## 指令的格式

### 指令的基本格式

![](/images/计算机/计算机组成原理/234.png)

#### 零地址指令

![](/images/计算机/计算机组成原理/235.png)

#### 一地址指令

![](/images/计算机/计算机组成原理/236.png)

#### 二地址指令

![](/images/计算机/计算机组成原理/237.png)

#### 三地址指令

![](/images/计算机/计算机组成原理/238.png)

#### 四地址指令

![](/images/计算机/计算机组成原理/239.png)



### 定长操作码指令格式

指令系统中所有**指令的操作码长度都相同**。

一般n位操作码字段的指令系统最大能够表示2^n^条指令。

- 优点：**简化计算机硬件设计，提高指令译码和识别速度**很有利。当计算机字长为32位或更长时，这是常规用法。
- 缺点：指令数量增加时会占用更多固定位，留给表示操作数地址的位数受限。

### 扩展操作码指令格式

为了在指令字长有限的前提下仍保持比较丰富的指令种类，可采取**可变长度操作码**，即指令系统中各**指令的操作码长度可变**。

最常见的变长操作码方法是**扩展操作码**，它使操作码的长度随地址码的减少而增加，不同地址数的指令可具有不同长度的操作码，从而在满足需要的前提下，有效地缩短指令字长。

- 优点：指令字长有限的前提下仍保持比较丰富的指令种类。
- 缺点：加了指令译码和分析的难度，使控制器的设计复杂化。

![](/images/计算机/计算机组成原理/242.png)

![](/images/计算机/计算机组成原理/244.png)

除这种安排外，还有其他多种扩展方法，如形成15条三地址指令、12条二地址指令、63条一地址指令和16条零地址指令，共106条指令。 

![](/images/计算机/计算机组成原理/243.png)

通常情况下，**对使用频率较高的指令分配较短的操作码**，**对使用频率较低的指令分配较长的操作码**，从而尽可能减少指令译码和分析的时间。

## 指令的操作类型

![](/images/计算机/计算机组成原理/241.png)

::: tip

调用指令和转移指令的区别：执行调用指令时必须保存下一条指令的地址（返回地址），当子程序执行结束时，根据返回地址返回到主程序继续执行；而转移指令则不返回执行。

:::



# 指令的寻址方式

寻址方式是指寻找指令或操作数有效地址的方式，即确定本条指令的数据地址及下一条待执行指令的地址的方法。

## 指令寻址

寻找下一条将要执行的指令地址称为指令寻址。

### 顺序寻址

通过程序计数器PC加1条指令的长度，自动形成下一条指令的地址。

PC自增的大小与编址方式、指令字长有关。

![](/images/计算机/计算机组成原理/245.png)

![](/images/计算机/计算机组成原理/246.png)

![](/images/计算机/计算机组成原理/247.png)



### 跳跃寻址

通过转移类指令实现。

跳跃是指由本条指令给出下条指令地址的计算方式，而是否跳跃可能受到状态寄存器的控制。

跳跃的方式分为：

1. 绝对转移：地址码直接指出转移目标地址。
2. 相对转移：地址码指出转移目的地址相对于当前PC值的偏移量。

由于CPU总是根据PC的内容去主存取指令的，因此转移指令执行的结果是修改PC值，下一条指令仍然通过PC给出。 

![](/images/计算机/计算机组成原理/248.png)

## 数据寻址

寻找本条指令的数据地址称为数据寻址。
